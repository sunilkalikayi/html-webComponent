{"version":3,"names":["createWebpackConfig","workspaceDir","entryFiles","title","publicDir","baseConfig","createBaseConfig","browserConfig","createBrowserConfig","combined","merge","output","path","resolve","publicPath","optimization","minimize","minimizer","TerserPlugin","terserOptions","parse","ecma","compress","warnings","comparisons","inline","mangle","safari10","comments","ascii_only","CssMinimizerPlugin","minimizerOptions","preset","minifyFontValues","removeQuotes","splitChunks","chunks","name","runtimeChunk","entrypoint","plugins","HtmlWebpackPlugin","inject","templateContent","html","minify","removeComments","collapseWhitespace","removeRedundantAttributes","useShortDoctype","removeEmptyAttributes","removeStyleLinkTypeAttributes","keepClosingSlash","minifyJS","minifyCSS","minifyURLs","ProvidePlugin","process","fallbacksProvidePluginConfig"],"sources":["webpack.browser.config.ts"],"sourcesContent":["import { Configuration, ProvidePlugin } from 'webpack';\nimport TerserPlugin from 'terser-webpack-plugin';\nimport CssMinimizerPlugin from 'css-minimizer-webpack-plugin';\nimport path from 'path';\nimport HtmlWebpackPlugin from 'html-webpack-plugin';\nimport { merge } from 'webpack-merge';\nimport { fallbacksProvidePluginConfig } from '@teambit/webpack';\n\nimport { html } from './html';\nimport createBaseConfig from './webpack.base.config';\n\nexport default function createWebpackConfig(\n  workspaceDir: string,\n  entryFiles: string[],\n  title: string,\n  publicDir: string\n): Configuration {\n  const baseConfig = createBaseConfig(workspaceDir, entryFiles);\n  const browserConfig = createBrowserConfig(workspaceDir, title, publicDir);\n\n  const combined = merge(baseConfig, browserConfig);\n\n  return combined;\n}\n\nfunction createBrowserConfig(workspaceDir: string, title: string, publicDir: string) {\n  const browserConfig: Configuration = {\n    // target: 'web', // already default\n\n    output: {\n      path: path.resolve(workspaceDir, publicDir),\n      // webpack uses `publicPath` to determine where the app is being served from.\n      // It requires a trailing slash, or the file assets will get an incorrect path.\n      // We inferred the \"public path\" (such as / or /my-project) from homepage.\n      publicPath: '/',\n    },\n\n    optimization: {\n      minimize: true,\n      minimizer: [\n        // This is only used in production mode\n        new TerserPlugin({\n          terserOptions: {\n            parse: {\n              // We want terser to parse ecma 8 code. However, we don't want it\n              // to apply any minification steps that turns valid ecma 5 code\n              // into invalid ecma 5 code. This is why the 'compress' and 'output'\n              // sections only apply transformations that are ecma 5 safe\n              // https://github.com/facebook/create-react-app/pull/4234\n              ecma: 8,\n            },\n            compress: {\n              ecma: 5,\n              warnings: false,\n              // Disabled because of an issue with Uglify breaking seemingly valid code:\n              // https://github.com/facebook/create-react-app/issues/2376\n              // Pending further investigation:\n              // https://github.com/mishoo/UglifyJS2/issues/2011\n              comparisons: false,\n              // Disabled because of an issue with Terser breaking valid code:\n              // https://github.com/facebook/create-react-app/issues/5250\n              // Pending further investigation:\n              // https://github.com/terser-js/terser/issues/120\n              inline: 2,\n            },\n            mangle: {\n              safari10: true,\n            },\n            output: {\n              ecma: 5,\n              comments: false,\n              // Turned on because emoji and regex is not minified properly using default\n              // https://github.com/facebook/create-react-app/issues/2488\n              ascii_only: true,\n            },\n          },\n        }),\n        new CssMinimizerPlugin({\n          minimizerOptions: {\n            preset: [\n              'default',\n              {\n                minifyFontValues: { removeQuotes: false },\n              },\n            ],\n          },\n        }),\n      ],\n      // Automatically split vendor and commons\n      // https://twitter.com/wSokra/status/969633336732905474\n      // https://medium.com/webpack/webpack-4-code-splitting-chunk-graph-and-the-splitchunks-optimization-be739a861366\n      splitChunks: {\n        chunks: 'all',\n        name: false,\n      },\n      // Keep the runtime chunk separated to enable long term caching\n      // https://twitter.com/wSokra/status/969679223278505985\n      // https://github.com/facebook/create-react-app/issues/5358\n      runtimeChunk: {\n        name: (entrypoint) => `runtime-${entrypoint.name}`,\n      },\n    },\n\n    plugins: [\n      new HtmlWebpackPlugin({\n        inject: true,\n        templateContent: html(title),\n\n        minify: {\n          removeComments: true,\n          collapseWhitespace: true,\n          removeRedundantAttributes: true,\n          useShortDoctype: true,\n          removeEmptyAttributes: true,\n          removeStyleLinkTypeAttributes: true,\n          keepClosingSlash: true,\n          minifyJS: true,\n          minifyCSS: true,\n          minifyURLs: true,\n        },\n      }),\n      new ProvidePlugin({ process: fallbacksProvidePluginConfig.process }),\n    ],\n  };\n\n  return browserConfig;\n}\n"],"mappings":"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"}