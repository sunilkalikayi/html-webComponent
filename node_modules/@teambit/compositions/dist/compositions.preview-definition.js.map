{"version":3,"names":["CompositionPreviewDefinition","constructor","compositions","renderTemplatePath","context","renderTemplatePathByEnv","env","getMounter","getModuleMap","components","map","getPreviewFiles","getMetadata","component","getCompositions","composition","displayName","identifier"],"sources":["compositions.preview-definition.ts"],"sourcesContent":["import { Component, ComponentMap } from '@teambit/component';\nimport type { ExecutionContext, Environment } from '@teambit/envs';\nimport { PreviewDefinition } from '@teambit/preview';\nimport { AbstractVinyl } from '@teambit/legacy/dist/consumer/component/sources';\n\nimport { CompositionsMain } from './compositions.main.runtime';\nimport { CompositionBrowserMetadataObject } from './composition';\n\nexport class CompositionPreviewDefinition implements PreviewDefinition {\n  readonly prefix = 'compositions';\n  readonly includePeers = true;\n\n  constructor(private compositions: CompositionsMain) {}\n\n  async renderTemplatePath(context: ExecutionContext): Promise<string> {\n    return this.renderTemplatePathByEnv(context.env);\n  }\n\n  async renderTemplatePathByEnv(env: Environment) {\n    return env.getMounter();\n  }\n\n  async getModuleMap(components: Component[]): Promise<ComponentMap<AbstractVinyl[]>> {\n    const map = this.compositions.getPreviewFiles(components);\n    return map;\n  }\n\n  async getMetadata(component: Component): Promise<CompositionBrowserMetadataObject> {\n    const compositions = this.compositions\n      .getCompositions(component)\n      .map((composition) => ({ displayName: composition.displayName, identifier: composition.identifier }));\n    return {\n      compositions,\n    };\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;AAQO,MAAMA,4BAA4B,CAA8B;EAIrEC,WAAW,CAASC,YAA8B,EAAE;IAAA,KAAhCA,YAA8B,GAA9BA,YAA8B;IAAA,gDAHhC,cAAc;IAAA,sDACR,IAAI;EAEyB;EAErD,MAAMC,kBAAkB,CAACC,OAAyB,EAAmB;IACnE,OAAO,IAAI,CAACC,uBAAuB,CAACD,OAAO,CAACE,GAAG,CAAC;EAClD;EAEA,MAAMD,uBAAuB,CAACC,GAAgB,EAAE;IAC9C,OAAOA,GAAG,CAACC,UAAU,EAAE;EACzB;EAEA,MAAMC,YAAY,CAACC,UAAuB,EAA0C;IAClF,MAAMC,GAAG,GAAG,IAAI,CAACR,YAAY,CAACS,eAAe,CAACF,UAAU,CAAC;IACzD,OAAOC,GAAG;EACZ;EAEA,MAAME,WAAW,CAACC,SAAoB,EAA6C;IACjF,MAAMX,YAAY,GAAG,IAAI,CAACA,YAAY,CACnCY,eAAe,CAACD,SAAS,CAAC,CAC1BH,GAAG,CAAEK,WAAW,KAAM;MAAEC,WAAW,EAAED,WAAW,CAACC,WAAW;MAAEC,UAAU,EAAEF,WAAW,CAACE;IAAW,CAAC,CAAC,CAAC;IACvG,OAAO;MACLf;IACF,CAAC;EACH;AACF;AAAC"}