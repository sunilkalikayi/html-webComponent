{"version":3,"names":["Workspace","routeSlot","menuSlot","sidebar","workspaceUI","onSidebarTogglerChange","reactions","useComponentNotifications","workspace","useWorkspace","isSidebarOpen","handleSidebarToggle","useReducer","x","sidebarOpenness","Layout","row","right","styles","emptyContainer","setComponents","components","workspaceWrapper","topbar","name","icon","main","splitter","e","stopPropagation","notifications","useNotifications","useMemo","onComponentAdded","comps","notificationId","log","pluralize","length","map","comp","id","toString","join","setTimeout","dismiss","onComponentRemoved","ids"],"sources":["workspace.tsx"],"sourcesContent":["import 'reset-css';\nimport pluralize from 'pluralize';\nimport React, { useReducer, useMemo } from 'react';\nimport { Route } from 'react-router-dom';\nimport type { ComponentModel } from '@teambit/component';\nimport type { ComponentID } from '@teambit/component-id';\nimport { useNotifications } from '@teambit/ui-foundation.ui.notifications.notification-context';\nimport { RouteSlot, SlotRouter } from '@teambit/ui-foundation.ui.react-router.slot-router';\nimport { Corner } from '@teambit/ui-foundation.ui.corner';\nimport { Collapser } from '@teambit/ui-foundation.ui.buttons.collapser';\nimport { SplitPane, Pane, Layout } from '@teambit/base-ui.surfaces.split-pane.split-pane';\nimport { HoverSplitter } from '@teambit/base-ui.surfaces.split-pane.hover-splitter';\nimport { TopBar } from '@teambit/ui-foundation.ui.top-bar';\n\nimport { useWorkspace } from './use-workspace';\nimport { WorkspaceOverview } from './workspace-overview';\nimport { WorkspaceProvider } from './workspace-provider';\nimport styles from './workspace.module.scss';\nimport WorkspaceUI from '../../workspace.ui.runtime';\n\nexport type WorkspaceProps = {\n  routeSlot: RouteSlot;\n  menuSlot: RouteSlot;\n  sidebar: JSX.Element;\n  workspaceUI: WorkspaceUI;\n  onSidebarTogglerChange: (callback: () => void) => void;\n};\n\n/**\n * main workspace component.\n */\nexport function Workspace({ routeSlot, menuSlot, sidebar, workspaceUI, onSidebarTogglerChange }: WorkspaceProps) {\n  const reactions = useComponentNotifications();\n  const { workspace } = useWorkspace(reactions);\n\n  const [isSidebarOpen, handleSidebarToggle] = useReducer((x) => !x, true);\n  const sidebarOpenness = isSidebarOpen ? Layout.row : Layout.right;\n\n  onSidebarTogglerChange(handleSidebarToggle);\n\n  if (!workspace) {\n    return <div className={styles.emptyContainer}></div>;\n  }\n\n  workspaceUI.setComponents(workspace.components);\n\n  return (\n    <WorkspaceProvider workspace={workspace}>\n      <div className={styles.workspaceWrapper}>\n        <TopBar\n          className={styles.topbar}\n          Corner={() => <Corner name={workspace.name} icon={workspace.icon} />}\n          menu={menuSlot}\n        />\n\n        <SplitPane className={styles.main} size={264} layout={sidebarOpenness}>\n          <Pane className={styles.sidebar}>{sidebar}</Pane>\n          <HoverSplitter className={styles.splitter}>\n            <Collapser\n              isOpen={isSidebarOpen}\n              onMouseDown={(e) => e.stopPropagation()} // avoid split-pane drag\n              onClick={handleSidebarToggle}\n              tooltipContent={`${isSidebarOpen ? 'Hide' : 'Show'} side panel`}\n            />\n          </HoverSplitter>\n          <Pane>\n            <SlotRouter slot={routeSlot}>\n              <Route index element={<WorkspaceOverview />} />\n            </SlotRouter>\n          </Pane>\n        </SplitPane>\n      </div>\n    </WorkspaceProvider>\n  );\n}\nfunction useComponentNotifications() {\n  const notifications = useNotifications();\n\n  // memo not really needed, but for peace of mind\n  return useMemo(\n    () => ({\n      onComponentAdded: (comps: ComponentModel[]) => {\n        const notificationId = notifications.log(\n          `added ${pluralize('component', comps.length)}: ${comps.map((comp) => comp.id.toString()).join(', ')}`\n        );\n        setTimeout(() => notifications.dismiss(notificationId), 12 * 1000);\n      },\n\n      onComponentRemoved: (ids: ComponentID[]) => {\n        const notificationId = notifications.log(\n          `removed ${pluralize('component', ids.length)} ${ids.map((id) => id.toString()).join(', ')}`\n        );\n        setTimeout(() => notifications.dismiss(notificationId), 12 * 1000);\n      },\n    }),\n    [notifications]\n  );\n}\n"],"mappings":"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"}