"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
require("core-js/modules/es.array.iterator.js");
require("core-js/modules/es.promise.js");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.EnvsUnsetCmd = void 0;
function _defineProperty2() {
  const data = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
  _defineProperty2 = function () {
    return data;
  };
  return data;
}
function _constants() {
  const data = require("@teambit/legacy/dist/constants");
  _constants = function () {
    return data;
  };
  return data;
}
function _chalk() {
  const data = _interopRequireDefault(require("chalk"));
  _chalk = function () {
    return data;
  };
  return data;
}
class EnvsUnsetCmd {
  constructor(workspace) {
    this.workspace = workspace;
    (0, _defineProperty2().default)(this, "name", 'unset <component-pattern>');
    (0, _defineProperty2().default)(this, "description", 'un-sets an env from components that were previously set by "bit env set" or by a component template');
    (0, _defineProperty2().default)(this, "arguments", [{
      name: 'component-pattern',
      description: 'component name, component id, or component pattern. use component pattern to select multiple components. \nuse comma to separate patterns and "!" to exclude. e.g. "ui/**, !ui/button"\nwrap the pattern with quotes'
    }]);
    (0, _defineProperty2().default)(this, "options", []);
    (0, _defineProperty2().default)(this, "group", 'development');
    (0, _defineProperty2().default)(this, "extendedDescription", `keep in mind that this doesn't remove envs that are set in the variants.
in only removes envs that appear in the .bitmap file, which were previously configured via "bit env set".
the purpose of this command is to remove the specific settings and let the the variants in workspace.jsonc to control the env.
${(0, _constants().PATTERN_HELP)('env unset')}`);
  }
  async report([pattern]) {
    const componentIds = await this.workspace.idsByPattern(pattern);
    const {
      changed
    } = await this.workspace.unsetEnvFromComponents(componentIds);
    if (!changed.length) {
      return _chalk().default.yellow(`unable to find any component matching the pattern with env configured in the .bitmap file`);
    }
    return `successfully removed env from the following component(s):
${changed.map(id => id.toString()).join('\n')}`;
  }
}
exports.EnvsUnsetCmd = EnvsUnsetCmd;

//# sourceMappingURL=envs-unset.cmd.js.map