{"version":3,"names":["isTsx","CodeUI","constructor","host","fileIconSlot","registerEnvFileIcon","icons","register","provider","component","componentCompare","_","harmony","config","String","get","ui","section","CodeSection","fileName","test","staticStorageUrl","undefined","registerRoute","route","registerWidget","navigationLink","order","codeCompare","CodeCompareSection","registerNavigation","props","registerRoutes","ComponentAspect","ComponentCompareAspect","UIRuntime","Slot","withType","CodeAspect","addRuntime"],"sources":["code.ui.runtime.tsx"],"sourcesContent":["import { ComponentAspect, ComponentUI } from '@teambit/component';\nimport { UIRuntime } from '@teambit/ui';\nimport React from 'react';\nimport { Harmony, SlotRegistry, Slot } from '@teambit/harmony';\nimport type { FileIconMatch } from '@teambit/code.ui.utils.get-file-icon';\nimport { staticStorageUrl } from '@teambit/base-ui.constants.storage';\nimport { CodePage } from '@teambit/code.ui.code-tab-page';\nimport { ComponentCompareUI, ComponentCompareAspect } from '@teambit/component-compare';\nimport { CodeAspect } from './code.aspect';\nimport { CodeSection } from './code.section';\nimport { CodeCompareSection } from './code.compare.section';\n\nconst isTsx = /\\.tsx$/;\n\nexport type FileIconSlot = SlotRegistry<FileIconMatch[]>;\n\n/**\n * Component code tab aspect. Presents the code tab page and allows to control the code tab and register specific icons for each file type.\n *  @example CodeUI.registerEnvFileIcon([(fileName) => (/your-regexp/.test(fileName) ? 'your.icon.url' : undefined)])\n */\nexport class CodeUI {\n  constructor(\n    /**\n     * register an icon for a specific file type. pass icon and a match method/regexp\n     */\n    private host: string,\n    private fileIconSlot?: FileIconSlot\n  ) {}\n\n  getCodePage = () => {\n    return <CodePage fileIconSlot={this.fileIconSlot} host={this.host} />;\n  };\n\n  registerEnvFileIcon(icons: FileIconMatch[]) {\n    this.fileIconSlot?.register(icons);\n    return this;\n  }\n  static dependencies = [ComponentAspect, ComponentCompareAspect];\n\n  static runtime = UIRuntime;\n\n  static slots = [Slot.withType<string>()];\n\n  static async provider(\n    [component, componentCompare]: [ComponentUI, ComponentCompareUI],\n    _,\n    [fileIconSlot]: [FileIconSlot],\n    harmony: Harmony\n  ) {\n    const { config } = harmony;\n    const host = String(config.get('teambit.harmony/bit'));\n    const ui = new CodeUI(host, fileIconSlot);\n    const section = new CodeSection(ui);\n    // overrides the default tsx react icon with the typescript icon\n    ui.registerEnvFileIcon([\n      (fileName) => (isTsx.test(fileName) ? `${staticStorageUrl}/file-icons/file_type_typescript.svg` : undefined),\n    ]);\n    component.registerRoute([section.route]);\n    component.registerWidget(section.navigationLink, section.order);\n    const codeCompare = new CodeCompareSection(fileIconSlot);\n    componentCompare.registerNavigation({\n      props: codeCompare.navigationLink,\n      order: codeCompare.navigationLink.order,\n    });\n    componentCompare.registerRoutes([codeCompare.route]);\n    return ui;\n  }\n}\n\nCodeAspect.addRuntime(CodeUI);\n"],"mappings":";;;;;;;;;;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA,MAAMA,KAAK,GAAG,QAAQ;AAItB;AACA;AACA;AACA;AACO,MAAMC,MAAM,CAAC;EAClBC,WAAW;EACT;AACJ;AACA;EACYC,IAAY,EACZC,YAA2B,EACnC;IAAA,KAFQD,IAAY,GAAZA,IAAY;IAAA,KACZC,YAA2B,GAA3BA,YAA2B;IAAA,qDAGvB,MAAM;MAClB,oBAAO,+BAAC,kBAAQ;QAAC,YAAY,EAAE,IAAI,CAACA,YAAa;QAAC,IAAI,EAAE,IAAI,CAACD;MAAK,EAAG;IACvE,CAAC;EAJE;EAMHE,mBAAmB,CAACC,KAAsB,EAAE;IAAA;IAC1C,0BAAI,CAACF,YAAY,uDAAjB,mBAAmBG,QAAQ,CAACD,KAAK,CAAC;IAClC,OAAO,IAAI;EACb;EAOA,aAAaE,QAAQ,CACnB,CAACC,SAAS,EAAEC,gBAAgB,CAAoC,EAChEC,CAAC,EACD,CAACP,YAAY,CAAiB,EAC9BQ,OAAgB,EAChB;IACA,MAAM;MAAEC;IAAO,CAAC,GAAGD,OAAO;IAC1B,MAAMT,IAAI,GAAGW,MAAM,CAACD,MAAM,CAACE,GAAG,CAAC,qBAAqB,CAAC,CAAC;IACtD,MAAMC,EAAE,GAAG,IAAIf,MAAM,CAACE,IAAI,EAAEC,YAAY,CAAC;IACzC,MAAMa,OAAO,GAAG,KAAIC,oBAAW,EAACF,EAAE,CAAC;IACnC;IACAA,EAAE,CAACX,mBAAmB,CAAC,CACpBc,QAAQ,IAAMnB,KAAK,CAACoB,IAAI,CAACD,QAAQ,CAAC,GAAI,GAAEE,mCAAiB,sCAAqC,GAAGC,SAAU,CAC7G,CAAC;IACFb,SAAS,CAACc,aAAa,CAAC,CAACN,OAAO,CAACO,KAAK,CAAC,CAAC;IACxCf,SAAS,CAACgB,cAAc,CAACR,OAAO,CAACS,cAAc,EAAET,OAAO,CAACU,KAAK,CAAC;IAC/D,MAAMC,WAAW,GAAG,KAAIC,iCAAkB,EAACzB,YAAY,CAAC;IACxDM,gBAAgB,CAACoB,kBAAkB,CAAC;MAClCC,KAAK,EAAEH,WAAW,CAACF,cAAc;MACjCC,KAAK,EAAEC,WAAW,CAACF,cAAc,CAACC;IACpC,CAAC,CAAC;IACFjB,gBAAgB,CAACsB,cAAc,CAAC,CAACJ,WAAW,CAACJ,KAAK,CAAC,CAAC;IACpD,OAAOR,EAAE;EACX;AACF;AAAC;AAAA,gCA/CYf,MAAM,kBAiBK,CAACgC,4BAAe,EAAEC,0CAAsB,CAAC;AAAA,gCAjBpDjC,MAAM,aAmBAkC,eAAS;AAAA,gCAnBflC,MAAM,WAqBF,CAACmC,eAAI,CAACC,QAAQ,EAAU,CAAC;AA4B1CC,kBAAU,CAACC,UAAU,CAACtC,MAAM,CAAC"}