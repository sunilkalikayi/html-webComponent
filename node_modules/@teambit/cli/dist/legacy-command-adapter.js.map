{"version":3,"names":["LegacyCommandAdapter","constructor","cmd","cliExtension","name","description","helpUrl","options","opts","alias","extendedDescription","skipWorkspace","group","loader","private","migration","internal","commands","map","sub","action","params","res","_packageManagerArgs","data","code","__code","undefined","report","actionResult","json","JSON","parse"],"sources":["legacy-command-adapter.ts"],"sourcesContent":["import { LegacyCommand } from '@teambit/legacy/dist/cli/legacy-command';\nimport { Command, CommandOptions, GenericObject } from '.';\nimport { CLIMain } from './cli.main.runtime';\n\nexport class LegacyCommandAdapter implements Command {\n  alias: string;\n  name: string;\n  description: string;\n  options: CommandOptions;\n  extendedDescription?: string;\n  group?: string;\n  loader?: boolean;\n  commands: Command[];\n  private?: boolean;\n  migration?: boolean;\n  internal?: boolean;\n  skipWorkspace?: boolean;\n  helpUrl?: string;\n  _packageManagerArgs?: string[];\n  constructor(private cmd: LegacyCommand, cliExtension: CLIMain) {\n    this.name = cmd.name;\n    this.description = cmd.description;\n    this.helpUrl = cmd.helpUrl;\n    this.options = cmd.opts || [];\n    this.alias = cmd.alias;\n    this.extendedDescription = cmd.extendedDescription;\n    this.skipWorkspace = cmd.skipWorkspace;\n    this.group = cmd.group;\n    this.loader = cmd.loader;\n    this.private = cmd.private;\n    this.migration = cmd.migration;\n    this.internal = cmd.internal;\n    this.commands = (cmd.commands || []).map((sub) => new LegacyCommandAdapter(sub, cliExtension));\n  }\n\n  private async action(params: any, options: { [key: string]: any }): Promise<ActionResult> {\n    const res = await this.cmd.action(params, options, this._packageManagerArgs);\n    let data = res;\n    let code = 0;\n    if (res && res.__code !== undefined) {\n      data = res.data;\n      code = res.__code;\n    }\n    const report = this.cmd.report(data, params, options);\n    return {\n      code,\n      report,\n    };\n  }\n\n  async report(params: any, options: { [key: string]: any }): Promise<{ data: string; code: number }> {\n    const actionResult = await this.action(params, options);\n    return { data: actionResult.report, code: actionResult.code };\n  }\n\n  async json(params: any, options: { [key: string]: any }): Promise<GenericObject> {\n    const actionResult = await this.action(params, options);\n    return {\n      data: JSON.parse(actionResult.report),\n      code: actionResult.code,\n    };\n  }\n}\n\ntype ActionResult = {\n  code: number;\n  report: string;\n};\n"],"mappings":";;;;;;;;;;;;;;;;AAIO,MAAMA,oBAAoB,CAAoB;EAenDC,WAAW,CAASC,GAAkB,EAAEC,YAAqB,EAAE;IAAA,KAA3CD,GAAkB,GAAlBA,GAAkB;IAAA;IAAA;IAAA;IAAA;IAAA;IAAA;IAAA;IAAA;IAAA;IAAA;IAAA;IAAA;IAAA;IAAA;IACpC,IAAI,CAACE,IAAI,GAAGF,GAAG,CAACE,IAAI;IACpB,IAAI,CAACC,WAAW,GAAGH,GAAG,CAACG,WAAW;IAClC,IAAI,CAACC,OAAO,GAAGJ,GAAG,CAACI,OAAO;IAC1B,IAAI,CAACC,OAAO,GAAGL,GAAG,CAACM,IAAI,IAAI,EAAE;IAC7B,IAAI,CAACC,KAAK,GAAGP,GAAG,CAACO,KAAK;IACtB,IAAI,CAACC,mBAAmB,GAAGR,GAAG,CAACQ,mBAAmB;IAClD,IAAI,CAACC,aAAa,GAAGT,GAAG,CAACS,aAAa;IACtC,IAAI,CAACC,KAAK,GAAGV,GAAG,CAACU,KAAK;IACtB,IAAI,CAACC,MAAM,GAAGX,GAAG,CAACW,MAAM;IACxB,IAAI,CAACC,OAAO,GAAGZ,GAAG,CAACY,OAAO;IAC1B,IAAI,CAACC,SAAS,GAAGb,GAAG,CAACa,SAAS;IAC9B,IAAI,CAACC,QAAQ,GAAGd,GAAG,CAACc,QAAQ;IAC5B,IAAI,CAACC,QAAQ,GAAG,CAACf,GAAG,CAACe,QAAQ,IAAI,EAAE,EAAEC,GAAG,CAAEC,GAAG,IAAK,IAAInB,oBAAoB,CAACmB,GAAG,EAAEhB,YAAY,CAAC,CAAC;EAChG;EAEA,MAAciB,MAAM,CAACC,MAAW,EAAEd,OAA+B,EAAyB;IACxF,MAAMe,GAAG,GAAG,MAAM,IAAI,CAACpB,GAAG,CAACkB,MAAM,CAACC,MAAM,EAAEd,OAAO,EAAE,IAAI,CAACgB,mBAAmB,CAAC;IAC5E,IAAIC,IAAI,GAAGF,GAAG;IACd,IAAIG,IAAI,GAAG,CAAC;IACZ,IAAIH,GAAG,IAAIA,GAAG,CAACI,MAAM,KAAKC,SAAS,EAAE;MACnCH,IAAI,GAAGF,GAAG,CAACE,IAAI;MACfC,IAAI,GAAGH,GAAG,CAACI,MAAM;IACnB;IACA,MAAME,MAAM,GAAG,IAAI,CAAC1B,GAAG,CAAC0B,MAAM,CAACJ,IAAI,EAAEH,MAAM,EAAEd,OAAO,CAAC;IACrD,OAAO;MACLkB,IAAI;MACJG;IACF,CAAC;EACH;EAEA,MAAMA,MAAM,CAACP,MAAW,EAAEd,OAA+B,EAA2C;IAClG,MAAMsB,YAAY,GAAG,MAAM,IAAI,CAACT,MAAM,CAACC,MAAM,EAAEd,OAAO,CAAC;IACvD,OAAO;MAAEiB,IAAI,EAAEK,YAAY,CAACD,MAAM;MAAEH,IAAI,EAAEI,YAAY,CAACJ;IAAK,CAAC;EAC/D;EAEA,MAAMK,IAAI,CAACT,MAAW,EAAEd,OAA+B,EAA0B;IAC/E,MAAMsB,YAAY,GAAG,MAAM,IAAI,CAACT,MAAM,CAACC,MAAM,EAAEd,OAAO,CAAC;IACvD,OAAO;MACLiB,IAAI,EAAEO,IAAI,CAACC,KAAK,CAACH,YAAY,CAACD,MAAM,CAAC;MACrCH,IAAI,EAAEI,YAAY,CAACJ;IACrB,CAAC;EACH;AACF;AAAC"}