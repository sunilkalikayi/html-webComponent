{"version":3,"names":["VariableDeclaration","predicate","node","kind","ts","SyntaxKind","getName","name","getText","getIdentifiers","ExportIdentifier","getSourceFile","fileName","transform","varDec","context","info","getQuickInfo","displaySig","body","displayString","location","getLocation","doc","jsDocToDocSchema","initializer","ArrowFunction","args","getParams","parameters","typeStr","parseReturnTypeFromQuickInfo","returnType","resolveType","modifiers","map","modifier","FunctionLikeSchema","parseTypeFromQuickInfo","type","VariableLikeSchema"],"sources":["variable-declaration.ts"],"sourcesContent":["import {\n  SchemaNode,\n  VariableLikeSchema,\n  FunctionLikeSchema,\n  Modifier,\n} from '@teambit/semantics.entities.semantic-schema';\nimport ts, { Node, VariableDeclaration as VariableDeclarationNode, ArrowFunction } from 'typescript';\nimport { SchemaTransformer } from '../schema-transformer';\nimport { SchemaExtractorContext } from '../schema-extractor-context';\nimport { ExportIdentifier } from '../export-identifier';\nimport { getParams } from './utils/get-params';\nimport { parseReturnTypeFromQuickInfo, parseTypeFromQuickInfo } from './utils/parse-type-from-quick-info';\nimport { jsDocToDocSchema } from './utils/jsdoc-to-doc-schema';\n\nexport class VariableDeclaration implements SchemaTransformer {\n  predicate(node: Node) {\n    return node.kind === ts.SyntaxKind.VariableDeclaration;\n  }\n\n  getName(node: VariableDeclarationNode) {\n    return node.name.getText();\n  }\n\n  async getIdentifiers(node: VariableDeclarationNode) {\n    return [new ExportIdentifier(node.name.getText(), node.getSourceFile().fileName)];\n  }\n\n  async transform(varDec: VariableDeclarationNode, context: SchemaExtractorContext): Promise<SchemaNode> {\n    const name = this.getName(varDec);\n    const info = await context.getQuickInfo(varDec.name);\n    const displaySig = info?.body?.displayString || '';\n    const location = context.getLocation(varDec);\n    const doc = await jsDocToDocSchema(varDec, context);\n    if (varDec.initializer?.kind === ts.SyntaxKind.ArrowFunction) {\n      const args = await getParams((varDec.initializer as ArrowFunction).parameters, context);\n      const typeStr = parseReturnTypeFromQuickInfo(info);\n      const returnType = await context.resolveType(varDec, typeStr);\n      const modifiers = varDec.modifiers?.map((modifier) => modifier.getText()) || [];\n      return new FunctionLikeSchema(location, name, args, returnType, displaySig, modifiers as Modifier[], doc);\n    }\n    const typeStr = parseTypeFromQuickInfo(info);\n    const type = await context.resolveType(varDec, typeStr);\n    return new VariableLikeSchema(location, name, displaySig, type, false, doc);\n  }\n}\n"],"mappings":";;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAMA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAGA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEO,MAAMA,mBAAmB,CAA8B;EAC5DC,SAAS,CAACC,IAAU,EAAE;IACpB,OAAOA,IAAI,CAACC,IAAI,KAAKC,qBAAE,CAACC,UAAU,CAACL,mBAAmB;EACxD;EAEAM,OAAO,CAACJ,IAA6B,EAAE;IACrC,OAAOA,IAAI,CAACK,IAAI,CAACC,OAAO,EAAE;EAC5B;EAEA,MAAMC,cAAc,CAACP,IAA6B,EAAE;IAClD,OAAO,CAAC,KAAIQ,oCAAgB,EAACR,IAAI,CAACK,IAAI,CAACC,OAAO,EAAE,EAAEN,IAAI,CAACS,aAAa,EAAE,CAACC,QAAQ,CAAC,CAAC;EACnF;EAEA,MAAMC,SAAS,CAACC,MAA+B,EAAEC,OAA+B,EAAuB;IAAA;IACrG,MAAMR,IAAI,GAAG,IAAI,CAACD,OAAO,CAACQ,MAAM,CAAC;IACjC,MAAME,IAAI,GAAG,MAAMD,OAAO,CAACE,YAAY,CAACH,MAAM,CAACP,IAAI,CAAC;IACpD,MAAMW,UAAU,GAAG,CAAAF,IAAI,aAAJA,IAAI,qCAAJA,IAAI,CAAEG,IAAI,+CAAV,WAAYC,aAAa,KAAI,EAAE;IAClD,MAAMC,QAAQ,GAAGN,OAAO,CAACO,WAAW,CAACR,MAAM,CAAC;IAC5C,MAAMS,GAAG,GAAG,MAAM,IAAAC,oCAAgB,EAACV,MAAM,EAAEC,OAAO,CAAC;IACnD,IAAI,wBAAAD,MAAM,CAACW,WAAW,wDAAlB,oBAAoBtB,IAAI,MAAKC,qBAAE,CAACC,UAAU,CAACqB,aAAa,EAAE;MAAA;MAC5D,MAAMC,IAAI,GAAG,MAAM,IAAAC,sBAAS,EAAEd,MAAM,CAACW,WAAW,CAAmBI,UAAU,EAAEd,OAAO,CAAC;MACvF,MAAMe,OAAO,GAAG,IAAAC,sDAA4B,EAACf,IAAI,CAAC;MAClD,MAAMgB,UAAU,GAAG,MAAMjB,OAAO,CAACkB,WAAW,CAACnB,MAAM,EAAEgB,OAAO,CAAC;MAC7D,MAAMI,SAAS,GAAG,sBAAApB,MAAM,CAACoB,SAAS,sDAAhB,kBAAkBC,GAAG,CAAEC,QAAQ,IAAKA,QAAQ,CAAC5B,OAAO,EAAE,CAAC,KAAI,EAAE;MAC/E,OAAO,KAAI6B,uCAAkB,EAAChB,QAAQ,EAAEd,IAAI,EAAEoB,IAAI,EAAEK,UAAU,EAAEd,UAAU,EAAEgB,SAAS,EAAgBX,GAAG,CAAC;IAC3G;IACA,MAAMO,OAAO,GAAG,IAAAQ,gDAAsB,EAACtB,IAAI,CAAC;IAC5C,MAAMuB,IAAI,GAAG,MAAMxB,OAAO,CAACkB,WAAW,CAACnB,MAAM,EAAEgB,OAAO,CAAC;IACvD,OAAO,KAAIU,uCAAkB,EAACnB,QAAQ,EAAEd,IAAI,EAAEW,UAAU,EAAEqB,IAAI,EAAE,KAAK,EAAEhB,GAAG,CAAC;EAC7E;AACF;AAAC"}