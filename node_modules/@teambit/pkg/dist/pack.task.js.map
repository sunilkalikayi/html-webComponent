{"version":3,"names":["PackTask","constructor","aspectId","packer","logger","execute","context","capsules","capsuleNetwork","seedersCapsules","info","length","packResults","packMultipleCapsules","override","packArtifactsDefs","getArtifactDefInCapsule","componentsResults","artifacts"],"sources":["pack.task.ts"],"sourcesContent":["import { BuildContext, BuiltTaskResult, BuildTask, TaskLocation } from '@teambit/builder';\nimport { Logger } from '@teambit/logger';\nimport { Packer } from './packer';\n\n/**\n * pack components to a .tgz file\n */\nexport class PackTask implements BuildTask {\n  readonly name = 'PackComponents';\n  readonly location: TaskLocation = 'end';\n  constructor(readonly aspectId: string, private packer: Packer, private logger: Logger) {}\n\n  async execute(context: BuildContext): Promise<BuiltTaskResult> {\n    const capsules = context.capsuleNetwork.seedersCapsules;\n    this.logger.info(`going to run pack on ${capsules.length} capsules`);\n    const packResults = await this.packer.packMultipleCapsules(capsules, { override: true }, false, true);\n    const packArtifactsDefs = this.packer.getArtifactDefInCapsule();\n\n    return {\n      componentsResults: packResults,\n      artifacts: [packArtifactsDefs],\n    };\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;AAIA;AACA;AACA;AACO,MAAMA,QAAQ,CAAsB;EAGzCC,WAAW,CAAUC,QAAgB,EAAUC,MAAc,EAAUC,MAAc,EAAE;IAAA,KAAlEF,QAAgB,GAAhBA,QAAgB;IAAA,KAAUC,MAAc,GAAdA,MAAc;IAAA,KAAUC,MAAc,GAAdA,MAAc;IAAA,8CAFrE,gBAAgB;IAAA,kDACE,KAAK;EACiD;EAExF,MAAMC,OAAO,CAACC,OAAqB,EAA4B;IAC7D,MAAMC,QAAQ,GAAGD,OAAO,CAACE,cAAc,CAACC,eAAe;IACvD,IAAI,CAACL,MAAM,CAACM,IAAI,CAAE,wBAAuBH,QAAQ,CAACI,MAAO,WAAU,CAAC;IACpE,MAAMC,WAAW,GAAG,MAAM,IAAI,CAACT,MAAM,CAACU,oBAAoB,CAACN,QAAQ,EAAE;MAAEO,QAAQ,EAAE;IAAK,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC;IACrG,MAAMC,iBAAiB,GAAG,IAAI,CAACZ,MAAM,CAACa,uBAAuB,EAAE;IAE/D,OAAO;MACLC,iBAAiB,EAAEL,WAAW;MAC9BM,SAAS,EAAE,CAACH,iBAAiB;IAC/B,CAAC;EACH;AACF;AAAC"}