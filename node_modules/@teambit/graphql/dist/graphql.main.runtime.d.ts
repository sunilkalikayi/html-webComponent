/// <reference types="node" />
import { Harmony, SlotRegistry } from '@teambit/harmony';
import { Logger, LoggerMain } from '@teambit/logger';
import { Express } from 'express';
import { PubSubEngine } from 'graphql-subscriptions';
import { Server } from 'http';
import { GraphQLServer } from './graphql-server';
import { Schema } from './schema';
export declare enum Verb {
    WRITE = "write",
    READ = "read"
}
export declare type GraphQLConfig = {
    port: number;
    subscriptionsPortRange: number[];
    subscriptionsPath: string;
};
export declare type GraphQLServerSlot = SlotRegistry<GraphQLServer>;
export declare type SchemaSlot = SlotRegistry<Schema>;
export declare type PubSubSlot = SlotRegistry<PubSubEngine>;
export declare type GraphQLServerOptions = {
    schemaSlot?: SchemaSlot;
    app?: Express;
    graphiql?: boolean;
    remoteSchemas?: GraphQLServer[];
    subscriptionsPortRange?: number[];
    onWsConnect?: Function;
};
export declare class GraphqlMain {
    /**
     * extension config
     */
    readonly config: GraphQLConfig;
    /**
     * slot for registering graphql modules
     */
    private moduleSlot;
    /**
     * harmony context.
     */
    private context;
    /**
     * logger extension.
     */
    readonly logger: Logger;
    private graphQLServerSlot;
    /**
     * graphql pubsub. allows to emit events to clients.
     */
    private pubSubSlot;
    constructor(
    /**
     * extension config
     */
    config: GraphQLConfig, 
    /**
     * slot for registering graphql modules
     */
    moduleSlot: SchemaSlot, 
    /**
     * harmony context.
     */
    context: Harmony, 
    /**
     * logger extension.
     */
    logger: Logger, graphQLServerSlot: GraphQLServerSlot, 
    /**
     * graphql pubsub. allows to emit events to clients.
     */
    pubSubSlot: PubSubSlot);
    get pubsub(): PubSubEngine;
    private modules;
    /**
     * returns the schema for a specific aspect by its id.
     */
    getSchema(aspectId: string): Schema | undefined;
    /**
     * get multiple schema by aspect ids.
     */
    getSchemas(aspectIds: string[]): Schema[];
    createServer(options: GraphQLServerOptions): Promise<Server>;
    /**
     * register a new graphql server.
     */
    registerServer(server: GraphQLServer): this;
    /**
     * register a pubsub client
     */
    registerPubSub(pubsub: PubSubEngine): this;
    /**
     * start a graphql server.
     */
    listen(port?: number, server?: Server, app?: Express): Promise<void>;
    /**
     * register a new graphql module.
     */
    register(schema: Schema): this;
    private getPort;
    /** create Subscription server with different port */
    private createSubscription;
    /** proxy ws Subscription server to avoid conflict with different websocket connections */
    private proxySubscription;
    private createRootModule;
    private buildModules;
    private getModuleDependencies;
    static slots: (((registerFn: () => string) => SlotRegistry<Schema>) | ((registerFn: () => string) => SlotRegistry<GraphQLServer>) | ((registerFn: () => string) => SlotRegistry<PubSubSlot>))[];
    static defaultConfig: {
        port: number;
        subscriptionsPortRange: number[];
        subscriptionsPath: string;
    };
    static runtime: import("@teambit/harmony").RuntimeDefinition;
    static dependencies: import("@teambit/harmony").Aspect[];
    static provider([loggerFactory]: [LoggerMain], config: GraphQLConfig, [moduleSlot, graphQLServerSlot, pubSubSlot]: [SchemaSlot, GraphQLServerSlot, PubSubSlot], context: Harmony): Promise<GraphqlMain>;
}
