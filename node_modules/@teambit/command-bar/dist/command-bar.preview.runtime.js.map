{"version":3,"names":["CommandBarPreview","constructor","pubSub","e","target","isEditable","isDenyListed","preventDefault","pub","CommandBarAspect","id","KeyEvent","document","addEventListener","handleKeyEvent","provider","pubsubPreview","PubsubAspect","PreviewRuntime","editableTags","element","includes","tagName","isContentEditable","addRuntime","isOpenCommandBarKeybinding"],"sources":["command-bar.preview.runtime.tsx"],"sourcesContent":["import { PreviewRuntime } from '@teambit/preview';\nimport { PubsubAspect, PubsubPreview } from '@teambit/pubsub';\nimport { isOpenCommandBarKeybinding } from './keybinding';\nimport { CommandBarAspect } from './command-bar.aspect';\nimport { KeyEvent } from './model/key-event';\n\nexport class CommandBarPreview {\n  constructor(private pubSub: PubsubPreview) {\n    document.addEventListener('keydown', this.handleKeyEvent);\n    document.addEventListener('keypress', this.handleKeyEvent);\n    document.addEventListener('keyup', this.handleKeyEvent);\n  }\n\n  handleKeyEvent = (e: KeyboardEvent) => {\n    const { target } = e;\n    if (!target || isEditable(target as HTMLElement)) return;\n    if (isDenyListed(e)) e.preventDefault();\n\n    this.pubSub.pub(CommandBarAspect.id, new KeyEvent(e));\n  };\n\n  static dependencies = [PubsubAspect];\n  static runtime = PreviewRuntime;\n  static async provider([pubSub]: [PubsubPreview]) {\n    const pubsubPreview = new CommandBarPreview(pubSub);\n    return pubsubPreview;\n  }\n}\n\nconst editableTags = ['INPUT', 'SELECT', 'TEXTAREA'];\nfunction isEditable(element: HTMLElement) {\n  return editableTags.includes(element.tagName) || element.isContentEditable;\n}\n\nCommandBarAspect.addRuntime(CommandBarPreview);\n\n// block default browser behavior that would override our keybinding.\nfunction isDenyListed(e: KeyboardEvent) {\n  return isOpenCommandBarKeybinding(e);\n}\n"],"mappings":";;;;;;;;;;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEO,MAAMA,iBAAiB,CAAC;EAC7BC,WAAW,CAASC,MAAqB,EAAE;IAAA,KAAvBA,MAAqB,GAArBA,MAAqB;IAAA,wDAMvBC,CAAgB,IAAK;MACrC,MAAM;QAAEC;MAAO,CAAC,GAAGD,CAAC;MACpB,IAAI,CAACC,MAAM,IAAIC,UAAU,CAACD,MAAM,CAAgB,EAAE;MAClD,IAAIE,YAAY,CAACH,CAAC,CAAC,EAAEA,CAAC,CAACI,cAAc,EAAE;MAEvC,IAAI,CAACL,MAAM,CAACM,GAAG,CAACC,8BAAgB,CAACC,EAAE,EAAE,KAAIC,oBAAQ,EAACR,CAAC,CAAC,CAAC;IACvD,CAAC;IAXCS,QAAQ,CAACC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAACC,cAAc,CAAC;IACzDF,QAAQ,CAACC,gBAAgB,CAAC,UAAU,EAAE,IAAI,CAACC,cAAc,CAAC;IAC1DF,QAAQ,CAACC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAACC,cAAc,CAAC;EACzD;EAYA,aAAaC,QAAQ,CAAC,CAACb,MAAM,CAAkB,EAAE;IAC/C,MAAMc,aAAa,GAAG,IAAIhB,iBAAiB,CAACE,MAAM,CAAC;IACnD,OAAOc,aAAa;EACtB;AACF;AAAC;AAAA,gCArBYhB,iBAAiB,kBAeN,CAACiB,sBAAY,CAAC;AAAA,gCAfzBjB,iBAAiB,aAgBXkB,yBAAc;AAOjC,MAAMC,YAAY,GAAG,CAAC,OAAO,EAAE,QAAQ,EAAE,UAAU,CAAC;AACpD,SAASd,UAAU,CAACe,OAAoB,EAAE;EACxC,OAAOD,YAAY,CAACE,QAAQ,CAACD,OAAO,CAACE,OAAO,CAAC,IAAIF,OAAO,CAACG,iBAAiB;AAC5E;AAEAd,8BAAgB,CAACe,UAAU,CAACxB,iBAAiB,CAAC;;AAE9C;AACA,SAASM,YAAY,CAACH,CAAgB,EAAE;EACtC,OAAO,IAAAsB,wCAA0B,EAACtB,CAAC,CAAC;AACtC"}