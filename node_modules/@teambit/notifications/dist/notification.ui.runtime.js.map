{"version":3,"names":["NotificationUI","provider","uiRuntimeExtension","constructor","message","level","id","v1","dispatch","type","content","time","Date","toISOString","add","MessageLevel","info","warning","error","success","props","messages","useReducer","notificationReducer","children","registerHudItem","registerRenderHooks","reactContext","renderContext","dismiss","UIAspect","UIRuntime","NotificationsAspect","addRuntime"],"sources":["notification.ui.runtime.tsx"],"sourcesContent":["import { UIAspect, UIRuntime, UiUI } from '@teambit/ui';\nimport React, { ReactNode, useReducer } from 'react';\nimport { v1 } from 'uuid';\n\nimport { NotificationContext } from '@teambit/ui-foundation.ui.notifications.notification-context';\nimport {\n  NotificationCenter,\n  NotificationCenterProps,\n} from '@teambit/ui-foundation.ui.notifications.notification-center';\nimport { MessageLevel, NotificationsStore } from '@teambit/ui-foundation.ui.notifications.store';\nimport { NotificationAction, notificationReducer } from './notification-reducer';\nimport { NotificationsAspect } from './notifications.aspect';\n\n/**\n * extension\n */\nexport default class NotificationUI implements NotificationsStore {\n  static dependencies = [UIAspect];\n\n  static runtime = UIRuntime;\n\n  static async provider([uiRuntimeExtension]: [UiUI]) {\n    return new NotificationUI(uiRuntimeExtension);\n  }\n\n  constructor(uiRuntimeExtension: UiUI) {\n    uiRuntimeExtension.registerHudItem(<this.render key=\"NotificationUI\" />);\n    uiRuntimeExtension.registerRenderHooks({ reactContext: this.renderContext });\n  }\n\n  private dispatch?: React.Dispatch<NotificationAction>;\n\n  /** adds a full message to the log */\n  add = (message: string, level: MessageLevel) => {\n    const id = v1();\n\n    this.dispatch?.({\n      type: 'add',\n      content: {\n        id,\n        message,\n        level,\n        time: new Date().toISOString(),\n      },\n    });\n\n    return id;\n  };\n\n  /** removes/archives a message from the log */\n  dismiss(id: string) {\n    this.dispatch?.({\n      type: 'dismiss',\n      id,\n    });\n  }\n\n  /** adds a message with level \"info\" to the log */\n  log = (message: string) => this.add(message, MessageLevel.info);\n  /** adds a message with level \"warning\" to the log */\n  warn = (message: string) => this.add(message, MessageLevel.warning);\n  /** adds a message with level \"error\" to the log */\n  error = (message: string) => this.add(message, MessageLevel.error);\n  /** adds a message with level \"success\" to the log */\n  success = (message: string) => this.add(message, MessageLevel.success);\n\n  /** removes all notifications */\n  clear = () => {\n    this.dispatch?.({\n      type: 'clear',\n    });\n  };\n\n  private render = (props: Omit<NotificationCenterProps, 'notifications'>) => {\n    // this code assumes a single place of render per instance of NotificationUI\n    const [messages, dispatch] = useReducer(notificationReducer, []);\n    this.dispatch = dispatch;\n\n    return <NotificationCenter {...props} notifications={messages} />;\n  };\n\n  private renderContext = ({ children }: { children: ReactNode }) => {\n    return <NotificationContext.Provider value={this}>{children}</NotificationContext.Provider>;\n  };\n}\n\nNotificationsAspect.addRuntime(NotificationUI);\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAIA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAA6D;AAAA;AAE7D;AACA;AACA;AACe,MAAMA,cAAc,CAA+B;EAKhE,aAAaC,QAAQ,CAAC,CAACC,kBAAkB,CAAS,EAAE;IAClD,OAAO,IAAIF,cAAc,CAACE,kBAAkB,CAAC;EAC/C;EAEAC,WAAW,CAACD,kBAAwB,EAAE;IAAA;IAAA,6CAQhC,CAACE,OAAe,EAAEC,KAAmB,KAAK;MAAA;MAC9C,MAAMC,EAAE,GAAG,IAAAC,UAAE,GAAE;MAEf,sBAAI,CAACC,QAAQ,mDAAb,wBAAI,EAAY;QACdC,IAAI,EAAE,KAAK;QACXC,OAAO,EAAE;UACPJ,EAAE;UACFF,OAAO;UACPC,KAAK;UACLM,IAAI,EAAE,IAAIC,IAAI,EAAE,CAACC,WAAW;QAC9B;MACF,CAAC,CAAC;MAEF,OAAOP,EAAE;IACX,CAAC;IAAA,6CAWMF,OAAe,IAAK,IAAI,CAACU,GAAG,CAACV,OAAO,EAAEW,4CAAY,CAACC,IAAI,CAAC;IAAA,8CAEvDZ,OAAe,IAAK,IAAI,CAACU,GAAG,CAACV,OAAO,EAAEW,4CAAY,CAACE,OAAO,CAAC;IAAA,+CAE1Db,OAAe,IAAK,IAAI,CAACU,GAAG,CAACV,OAAO,EAAEW,4CAAY,CAACG,KAAK,CAAC;IAAA,iDAEvDd,OAAe,IAAK,IAAI,CAACU,GAAG,CAACV,OAAO,EAAEW,4CAAY,CAACI,OAAO,CAAC;IAAA,+CAG9D,MAAM;MAAA;MACZ,uBAAI,CAACX,QAAQ,oDAAb,yBAAI,EAAY;QACdC,IAAI,EAAE;MACR,CAAC,CAAC;IACJ,CAAC;IAAA,gDAEiBW,KAAqD,IAAK;MAC1E;MACA,MAAM,CAACC,QAAQ,EAAEb,QAAQ,CAAC,GAAG,IAAAc,mBAAU,EAACC,0CAAmB,EAAE,EAAE,CAAC;MAChE,IAAI,CAACf,QAAQ,GAAGA,QAAQ;MAExB,oBAAO,+BAAC,kDAAkB,+BAAKY,KAAK;QAAE,aAAa,EAAEC;MAAS,GAAG;IACnE,CAAC;IAAA,uDAEuB,CAAC;MAAEG;IAAkC,CAAC,KAAK;MACjE,oBAAO,+BAAC,kDAAmB,CAAC,QAAQ;QAAC,KAAK,EAAE;MAAK,GAAEA,QAAQ,CAAgC;IAC7F,CAAC;IAzDCtB,kBAAkB,CAACuB,eAAe,eAAC,oCAAM,MAAM;MAAC,GAAG,EAAC;IAAgB,EAAG,CAAC;IACxEvB,kBAAkB,CAACwB,mBAAmB,CAAC;MAAEC,YAAY,EAAE,IAAI,CAACC;IAAc,CAAC,CAAC;EAC9E;EAqBA;EACAC,OAAO,CAACvB,EAAU,EAAE;IAAA;IAClB,uBAAI,CAACE,QAAQ,oDAAb,yBAAI,EAAY;MACdC,IAAI,EAAE,SAAS;MACfH;IACF,CAAC,CAAC;EACJ;;EAEA;AA2BF;AAAC;AAAA,gCApEoBN,cAAc,kBACX,CAAC8B,cAAQ,CAAC;AAAA,gCADb9B,cAAc,aAGhB+B,eAAS;AAmE5BC,oCAAmB,CAACC,UAAU,CAACjC,cAAc,CAAC"}