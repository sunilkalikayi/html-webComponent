{"version":3,"names":["Manifest","constructor","name","version","dependencies","toJson","options","devDependencies","peerDependencies","copyPeerToRuntime","manifest"],"sources":["manifest.ts"],"sourcesContent":["import { SemVer } from 'semver';\nimport { PackageName, SemverVersion } from '../dependencies';\n\n// export type ManifestDependenciesKeys = 'dependencies' | 'devDependencies' | 'peerDependencies';\n\nexport type ManifestDependenciesKeys = {\n  dependencies: 'dependencies';\n  devDependencies: 'devDependencies';\n  peerDependencies: 'peerDependencies';\n};\n\nexport type ManifestDependenciesKeysNames = keyof ManifestDependenciesKeys;\n\nexport type ManifestDependenciesObject = Partial<Record<ManifestDependenciesKeysNames, DepObjectValue>>;\n\nexport type DepObjectValue = Record<PackageName, SemverVersion>;\n\nexport interface ManifestToJsonOptions {\n  copyPeerToRuntime?: boolean;\n}\n\nexport class Manifest {\n  constructor(public name: string, public version: SemVer, public dependencies: ManifestDependenciesObject) {}\n\n  // Should be implemented on sub classes\n  // get dir(): string {\n  //   throw new GeneralError('not implemented');\n  // }\n\n  toJson(options: ManifestToJsonOptions = {}): Record<string, any> {\n    let dependencies = this.dependencies.dependencies || {};\n    const devDependencies = this.dependencies.devDependencies || {};\n    const peerDependencies = this.dependencies.peerDependencies || {};\n    if (options.copyPeerToRuntime) {\n      dependencies = { ...peerDependencies, ...dependencies };\n    }\n    const manifest = {\n      name: this.name,\n      version: this.version.version,\n      dependencies,\n      devDependencies,\n      peerDependencies,\n    };\n    // if (options.includeDir) {\n    //   return {\n    //     rootDir: this.dir,\n    //     manifest,\n    //   };\n    // }\n    return manifest;\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;AAGA;;AAkBO,MAAMA,QAAQ,CAAC;EACpBC,WAAW,CAAQC,IAAY,EAASC,OAAe,EAASC,YAAwC,EAAE;IAAA,KAAvFF,IAAY,GAAZA,IAAY;IAAA,KAASC,OAAe,GAAfA,OAAe;IAAA,KAASC,YAAwC,GAAxCA,YAAwC;EAAG;;EAE3G;EACA;EACA;EACA;;EAEAC,MAAM,CAACC,OAA8B,GAAG,CAAC,CAAC,EAAuB;IAC/D,IAAIF,YAAY,GAAG,IAAI,CAACA,YAAY,CAACA,YAAY,IAAI,CAAC,CAAC;IACvD,MAAMG,eAAe,GAAG,IAAI,CAACH,YAAY,CAACG,eAAe,IAAI,CAAC,CAAC;IAC/D,MAAMC,gBAAgB,GAAG,IAAI,CAACJ,YAAY,CAACI,gBAAgB,IAAI,CAAC,CAAC;IACjE,IAAIF,OAAO,CAACG,iBAAiB,EAAE;MAC7BL,YAAY,mCAAQI,gBAAgB,GAAKJ,YAAY,CAAE;IACzD;IACA,MAAMM,QAAQ,GAAG;MACfR,IAAI,EAAE,IAAI,CAACA,IAAI;MACfC,OAAO,EAAE,IAAI,CAACA,OAAO,CAACA,OAAO;MAC7BC,YAAY;MACZG,eAAe;MACfC;IACF,CAAC;IACD;IACA;IACA;IACA;IACA;IACA;IACA,OAAOE,QAAQ;EACjB;AACF;AAAC"}