{"version":3,"names":["WorkspaceManifest","Manifest","constructor","name","version","dependencies","envPeersAutoDetectPolicy","rootDir","componentsManifestsMap","dir","getComponentMap","toJson","options","manifest","installPeersFromEnvs","peersManifest","toVersionManifest","Object","assign","toJsonWithDir"],"sources":["workspace-manifest.ts"],"sourcesContent":["import { SemVer } from 'semver';\nimport { PeersAutoDetectPolicy } from '..';\n\nimport { ComponentsManifestsMap } from '../types';\nimport { Manifest, ManifestToJsonOptions, ManifestDependenciesObject } from './manifest';\n\nexport interface WorkspaceManifestToJsonOptions extends ManifestToJsonOptions {\n  installPeersFromEnvs?: boolean;\n}\n\nexport class WorkspaceManifest extends Manifest {\n  constructor(\n    // TODO: please prefer readonly on public\n    public name: string,\n    public version: SemVer,\n    public dependencies: ManifestDependenciesObject,\n    private envPeersAutoDetectPolicy: PeersAutoDetectPolicy | undefined,\n    private rootDir: string,\n    public componentsManifestsMap: ComponentsManifestsMap\n  ) {\n    super(name, version, dependencies);\n  }\n\n  get dir() {\n    return this.rootDir;\n  }\n\n  getComponentMap() {}\n\n  toJson(options: WorkspaceManifestToJsonOptions = {}): Record<string, any> {\n    const manifest = super.toJson(options);\n    if (options.installPeersFromEnvs) {\n      const peersManifest = this.envPeersAutoDetectPolicy?.toVersionManifest();\n      manifest.dependencies = manifest.dependencies || {};\n      Object.assign(manifest.dependencies, peersManifest);\n    }\n    return manifest;\n  }\n\n  toJsonWithDir(options: WorkspaceManifestToJsonOptions = {}): { rootDir: string; manifest: Record<string, any> } {\n    return {\n      manifest: this.toJson(options),\n      rootDir: this.rootDir,\n    };\n  }\n}\n"],"mappings":";;;;;;AAIA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAMO,MAAMA,iBAAiB,SAASC,oBAAQ,CAAC;EAC9CC,WAAW;EACT;EACOC,IAAY,EACZC,OAAe,EACfC,YAAwC,EACvCC,wBAA2D,EAC3DC,OAAe,EAChBC,sBAA8C,EACrD;IACA,KAAK,CAACL,IAAI,EAAEC,OAAO,EAAEC,YAAY,CAAC;IAAC,KAP5BF,IAAY,GAAZA,IAAY;IAAA,KACZC,OAAe,GAAfA,OAAe;IAAA,KACfC,YAAwC,GAAxCA,YAAwC;IAAA,KACvCC,wBAA2D,GAA3DA,wBAA2D;IAAA,KAC3DC,OAAe,GAAfA,OAAe;IAAA,KAChBC,sBAA8C,GAA9CA,sBAA8C;EAGvD;EAEA,IAAIC,GAAG,GAAG;IACR,OAAO,IAAI,CAACF,OAAO;EACrB;EAEAG,eAAe,GAAG,CAAC;EAEnBC,MAAM,CAACC,OAAuC,GAAG,CAAC,CAAC,EAAuB;IACxE,MAAMC,QAAQ,GAAG,KAAK,CAACF,MAAM,CAACC,OAAO,CAAC;IACtC,IAAIA,OAAO,CAACE,oBAAoB,EAAE;MAAA;MAChC,MAAMC,aAAa,4BAAG,IAAI,CAACT,wBAAwB,0DAA7B,sBAA+BU,iBAAiB,EAAE;MACxEH,QAAQ,CAACR,YAAY,GAAGQ,QAAQ,CAACR,YAAY,IAAI,CAAC,CAAC;MACnDY,MAAM,CAACC,MAAM,CAACL,QAAQ,CAACR,YAAY,EAAEU,aAAa,CAAC;IACrD;IACA,OAAOF,QAAQ;EACjB;EAEAM,aAAa,CAACP,OAAuC,GAAG,CAAC,CAAC,EAAsD;IAC9G,OAAO;MACLC,QAAQ,EAAE,IAAI,CAACF,MAAM,CAACC,OAAO,CAAC;MAC9BL,OAAO,EAAE,IAAI,CAACA;IAChB,CAAC;EACH;AACF;AAAC"}