{"version":3,"names":["Artifact","constructor","def","files","task","timestamp","Date","now","storage","storageResolver","name","DefaultResolver","description","generatedBy","aspectId","isEmpty","tar","toObject","id","fromArtifactObject","object","artifactDef"],"sources":["artifact.ts"],"sourcesContent":["import type { ArtifactFiles, ArtifactObject } from '@teambit/legacy/dist/consumer/component/sources/artifact-files';\nimport type { TaskDescriptor } from '../build-task';\nimport type { ArtifactDefinition } from './artifact-definition';\nimport { DefaultResolver } from '../storage/default-resolver';\n\nexport class Artifact {\n  constructor(\n    /**\n     * definition of the artifact.\n     */\n    readonly def: ArtifactDefinition,\n\n    readonly files: ArtifactFiles,\n    /**\n     * the declaring task.\n     */\n    readonly task: TaskDescriptor,\n    /**\n     * timestamp of the artifact creation.\n     */\n    readonly timestamp: number = Date.now()\n  ) {}\n\n  get storage() {\n    return this.storageResolver.name;\n  }\n\n  get storageResolver() {\n    return this.def.storageResolver || new DefaultResolver();\n  }\n\n  /**\n   * name of the artifact.\n   */\n  get name(): string {\n    return this.def.name;\n  }\n\n  /**\n   * description of the artifact.\n   */\n  get description() {\n    return this.def.description;\n  }\n\n  /**\n   * aspect id (string) that generated the artifact\n   */\n  get generatedBy(): string {\n    return this.def.generatedBy || this.task.aspectId;\n  }\n\n  isEmpty(): boolean {\n    return this.files.isEmpty();\n  }\n\n  /**\n   * archive all artifact files into a tar.\n   */\n  tar() {}\n\n  toObject(): ArtifactObject {\n    return {\n      name: this.name,\n      description: this.description,\n      generatedBy: this.generatedBy,\n      storage: this.storageResolver.name,\n      task: {\n        id: this.task.aspectId,\n        name: this.task.name,\n      },\n      files: this.files,\n    };\n  }\n\n  static fromArtifactObject(object: ArtifactObject): Artifact {\n    const artifactDef: ArtifactDefinition = {\n      name: object.name,\n      generatedBy: object.generatedBy,\n      description: object.description,\n    };\n\n    const task: TaskDescriptor = {\n      aspectId: object.task.id,\n      name: object.task.name,\n    };\n\n    return new Artifact(artifactDef, object.files, task);\n  }\n}\n"],"mappings":";;;;;;;AAGA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEO,MAAMA,QAAQ,CAAC;EACpBC,WAAW;EACT;AACJ;AACA;EACaC,GAAuB,EAEvBC,KAAoB;EAC7B;AACJ;AACA;EACaC,IAAoB;EAC7B;AACJ;AACA;EACaC,SAAiB,GAAGC,IAAI,CAACC,GAAG,EAAE,EACvC;IAAA,KAXSL,GAAuB,GAAvBA,GAAuB;IAAA,KAEvBC,KAAoB,GAApBA,KAAoB;IAAA,KAIpBC,IAAoB,GAApBA,IAAoB;IAAA,KAIpBC,SAAiB,GAAjBA,SAAiB;EACzB;EAEH,IAAIG,OAAO,GAAG;IACZ,OAAO,IAAI,CAACC,eAAe,CAACC,IAAI;EAClC;EAEA,IAAID,eAAe,GAAG;IACpB,OAAO,IAAI,CAACP,GAAG,CAACO,eAAe,IAAI,KAAIE,kCAAe,GAAE;EAC1D;;EAEA;AACF;AACA;EACE,IAAID,IAAI,GAAW;IACjB,OAAO,IAAI,CAACR,GAAG,CAACQ,IAAI;EACtB;;EAEA;AACF;AACA;EACE,IAAIE,WAAW,GAAG;IAChB,OAAO,IAAI,CAACV,GAAG,CAACU,WAAW;EAC7B;;EAEA;AACF;AACA;EACE,IAAIC,WAAW,GAAW;IACxB,OAAO,IAAI,CAACX,GAAG,CAACW,WAAW,IAAI,IAAI,CAACT,IAAI,CAACU,QAAQ;EACnD;EAEAC,OAAO,GAAY;IACjB,OAAO,IAAI,CAACZ,KAAK,CAACY,OAAO,EAAE;EAC7B;;EAEA;AACF;AACA;EACEC,GAAG,GAAG,CAAC;EAEPC,QAAQ,GAAmB;IACzB,OAAO;MACLP,IAAI,EAAE,IAAI,CAACA,IAAI;MACfE,WAAW,EAAE,IAAI,CAACA,WAAW;MAC7BC,WAAW,EAAE,IAAI,CAACA,WAAW;MAC7BL,OAAO,EAAE,IAAI,CAACC,eAAe,CAACC,IAAI;MAClCN,IAAI,EAAE;QACJc,EAAE,EAAE,IAAI,CAACd,IAAI,CAACU,QAAQ;QACtBJ,IAAI,EAAE,IAAI,CAACN,IAAI,CAACM;MAClB,CAAC;MACDP,KAAK,EAAE,IAAI,CAACA;IACd,CAAC;EACH;EAEA,OAAOgB,kBAAkB,CAACC,MAAsB,EAAY;IAC1D,MAAMC,WAA+B,GAAG;MACtCX,IAAI,EAAEU,MAAM,CAACV,IAAI;MACjBG,WAAW,EAAEO,MAAM,CAACP,WAAW;MAC/BD,WAAW,EAAEQ,MAAM,CAACR;IACtB,CAAC;IAED,MAAMR,IAAoB,GAAG;MAC3BU,QAAQ,EAAEM,MAAM,CAAChB,IAAI,CAACc,EAAE;MACxBR,IAAI,EAAEU,MAAM,CAAChB,IAAI,CAACM;IACpB,CAAC;IAED,OAAO,IAAIV,QAAQ,CAACqB,WAAW,EAAED,MAAM,CAACjB,KAAK,EAAEC,IAAI,CAAC;EACtD;AACF;AAAC"}