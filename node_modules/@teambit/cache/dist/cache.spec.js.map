{"version":3,"names":["describe","cacheDirectory","v4","cache","CacheMain","Logger","it","set","data","get","expect","to","equal","afterAll","rmdirSync","recursive"],"sources":["cache.spec.ts"],"sourcesContent":["import { v4 } from 'uuid';\nimport { rmdirSync } from 'fs';\nimport { expect } from 'chai';\nimport { Logger } from '@teambit/logger';\nimport { CacheMain } from './cache.main.runtime';\n\ndescribe('Cache Aspect', () => {\n  const cacheDirectory = `/tmp/bit/${v4()}`;\n  const cache = new CacheMain({ cacheDirectory }, new Logger('cache.main.runtime'));\n  it('it should set cache with ttl', async () => {\n    await cache.set('_foo', 'bar', 1000);\n    const data = await cache.get('_foo');\n    expect(data).to.equal('bar');\n  });\n\n  // this test is flaky, it fails often on CircleCI.\n  // it('it should expire cache', async () => {\n  //   await cache.set('_foo', 'bar', 1);\n  //   const data = await cache.get('_foo');\n  //   expect(data).to.equal(null);\n  // });\n\n  it('it should set cache without expire ttl', async () => {\n    await cache.set('_foo', 'bar');\n    const data = await cache.get('_foo');\n    expect(data).to.equal('bar');\n  });\n\n  afterAll(() => {\n    rmdirSync(cacheDirectory, { recursive: true });\n  });\n});\n"],"mappings":";;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEAA,QAAQ,CAAC,cAAc,EAAE,MAAM;EAC7B,MAAMC,cAAc,GAAI,YAAW,IAAAC,UAAE,GAAG,EAAC;EACzC,MAAMC,KAAK,GAAG,KAAIC,sBAAS,EAAC;IAAEH;EAAe,CAAC,EAAE,KAAII,gBAAM,EAAC,oBAAoB,CAAC,CAAC;EACjFC,EAAE,CAAC,8BAA8B,EAAE,YAAY;IAC7C,MAAMH,KAAK,CAACI,GAAG,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC;IACpC,MAAMC,IAAI,GAAG,MAAML,KAAK,CAACM,GAAG,CAAC,MAAM,CAAC;IACpC,IAAAC,cAAM,EAACF,IAAI,CAAC,CAACG,EAAE,CAACC,KAAK,CAAC,KAAK,CAAC;EAC9B,CAAC,CAAC;;EAEF;EACA;EACA;EACA;EACA;EACA;;EAEAN,EAAE,CAAC,wCAAwC,EAAE,YAAY;IACvD,MAAMH,KAAK,CAACI,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC;IAC9B,MAAMC,IAAI,GAAG,MAAML,KAAK,CAACM,GAAG,CAAC,MAAM,CAAC;IACpC,IAAAC,cAAM,EAACF,IAAI,CAAC,CAACG,EAAE,CAACC,KAAK,CAAC,KAAK,CAAC;EAC9B,CAAC,CAAC;EAEFC,QAAQ,CAAC,MAAM;IACb,IAAAC,eAAS,EAACb,cAAc,EAAE;MAAEc,SAAS,EAAE;IAAK,CAAC,CAAC;EAChD,CAAC,CAAC;AACJ,CAAC,CAAC"}