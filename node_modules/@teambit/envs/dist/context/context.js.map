{"version":3,"names":["ExecutionContext","constructor","upper","envRuntime","components","id","env","envDefinition","EnvDefinition","apply","name","args","Error"],"sources":["context.ts"],"sourcesContent":["import { EnvDefinition } from '../env-definition';\nimport { Environment } from '../environment';\n\nimport { EnvRuntime, Runtime } from '../runtime';\n\nexport type ServiceMap<T> = {\n  [env: string]: T;\n};\n\nexport class ExecutionContext {\n  constructor(\n    /**\n     * upper scope of all environment contexts.\n     */\n    readonly upper: Runtime,\n\n    /**\n     * runtime instance of the environment.\n     */\n    readonly envRuntime: EnvRuntime,\n\n    /**\n     * components applied in the execution context.\n     */\n    public components = envRuntime.components\n  ) {}\n\n  relatedContexts: string[] = [];\n\n  /**\n   * extension ID of the environment\n   */\n  get id() {\n    return this.envRuntime.id;\n  }\n\n  /**\n   * environment instance.\n   */\n  get env(): Environment {\n    return this.envRuntime.env;\n  }\n\n  get envDefinition(): EnvDefinition {\n    return new EnvDefinition(this.id, this.env);\n  }\n\n  apply<T>(name: string, args: any[]): T {\n    if (!this.env[name]) {\n      throw new Error(`method ${name} not implemented`);\n    }\n\n    return this.env[name].apply(this.env, ...args);\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AASO,MAAMA,gBAAgB,CAAC;EAC5BC,WAAW;EACT;AACJ;AACA;EACaC,KAAc;EAEvB;AACJ;AACA;EACaC,UAAsB;EAE/B;AACJ;AACA;EACWC,UAAU,GAAGD,UAAU,CAACC,UAAU,EACzC;IAAA,KAXSF,KAAc,GAAdA,KAAc;IAAA,KAKdC,UAAsB,GAAtBA,UAAsB;IAAA,KAKxBC,UAAU,GAAVA,UAAU;IAAA,yDAGS,EAAE;EAF3B;EAIH;AACF;AACA;EACE,IAAIC,EAAE,GAAG;IACP,OAAO,IAAI,CAACF,UAAU,CAACE,EAAE;EAC3B;;EAEA;AACF;AACA;EACE,IAAIC,GAAG,GAAgB;IACrB,OAAO,IAAI,CAACH,UAAU,CAACG,GAAG;EAC5B;EAEA,IAAIC,aAAa,GAAkB;IACjC,OAAO,KAAIC,8BAAa,EAAC,IAAI,CAACH,EAAE,EAAE,IAAI,CAACC,GAAG,CAAC;EAC7C;EAEAG,KAAK,CAAIC,IAAY,EAAEC,IAAW,EAAK;IACrC,IAAI,CAAC,IAAI,CAACL,GAAG,CAACI,IAAI,CAAC,EAAE;MACnB,MAAM,IAAIE,KAAK,CAAE,UAASF,IAAK,kBAAiB,CAAC;IACnD;IAEA,OAAO,IAAI,CAACJ,GAAG,CAACI,IAAI,CAAC,CAACD,KAAK,CAAC,IAAI,CAACH,GAAG,EAAE,GAAGK,IAAI,CAAC;EAChD;AACF;AAAC"}