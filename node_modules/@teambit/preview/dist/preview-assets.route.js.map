{"version":3,"names":["PreviewAssetsRoute","constructor","preview","logger","req","res","component","status","jsonp","error","result","getPreviewFiles","json","e","send","serverError"],"sources":["preview-assets.route.ts"],"sourcesContent":["import type { Request, Response, Route } from '@teambit/express';\nimport type { Component } from '@teambit/component';\nimport { serverError } from '@teambit/ui-foundation.ui.pages.static-error';\nimport type { Logger } from '@teambit/logger';\n\nimport { PreviewMain } from './preview.main.runtime';\n\nexport class PreviewAssetsRoute implements Route {\n  constructor(\n    /**\n     * preview extension.\n     */\n    private preview: PreviewMain,\n    private logger: Logger\n  ) {}\n\n  route = '/preview-assets';\n  method = 'get';\n\n  middlewares = [\n    async (req: Request, res: Response) => {\n      try {\n        // @ts-ignore TODO: @guy please fix.\n        const component = req.component as Component | undefined;\n        // if (!component) return res.status(404).send(noPreview());\n        if (!component) return res.status(404).jsonp({ error: 'not found' });\n        const result = await this.preview.getPreviewFiles(component);\n        if (!result) return res.status(404).jsonp({ error: 'not found' });\n        return res.json(result);\n      } catch (e: any) {\n        this.logger.error('failed getting preview assets', e);\n        return res.status(500).send(serverError());\n      }\n    },\n  ];\n}\n"],"mappings":";;;;;;;;;;;;;;;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAKO,MAAMA,kBAAkB,CAAkB;EAC/CC,WAAW;EACT;AACJ;AACA;EACYC,OAAoB,EACpBC,MAAc,EACtB;IAAA,KAFQD,OAAoB,GAApBA,OAAoB;IAAA,KACpBC,MAAc,GAAdA,MAAc;IAAA,+CAGhB,iBAAiB;IAAA,gDAChB,KAAK;IAAA,qDAEA,CACZ,OAAOC,GAAY,EAAEC,GAAa,KAAK;MACrC,IAAI;QACF;QACA,MAAMC,SAAS,GAAGF,GAAG,CAACE,SAAkC;QACxD;QACA,IAAI,CAACA,SAAS,EAAE,OAAOD,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,KAAK,CAAC;UAAEC,KAAK,EAAE;QAAY,CAAC,CAAC;QACpE,MAAMC,MAAM,GAAG,MAAM,IAAI,CAACR,OAAO,CAACS,eAAe,CAACL,SAAS,CAAC;QAC5D,IAAI,CAACI,MAAM,EAAE,OAAOL,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACC,KAAK,CAAC;UAAEC,KAAK,EAAE;QAAY,CAAC,CAAC;QACjE,OAAOJ,GAAG,CAACO,IAAI,CAACF,MAAM,CAAC;MACzB,CAAC,CAAC,OAAOG,CAAM,EAAE;QACf,IAAI,CAACV,MAAM,CAACM,KAAK,CAAC,+BAA+B,EAAEI,CAAC,CAAC;QACrD,OAAOR,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACO,IAAI,CAAC,IAAAC,kCAAW,GAAE,CAAC;MAC5C;IACF,CAAC,CACF;EApBE;AAqBL;AAAC"}