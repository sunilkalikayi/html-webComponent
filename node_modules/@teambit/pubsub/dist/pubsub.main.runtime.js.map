{"version":3,"names":["PubsubMain","topicUUID","topicMap","sub","callback","createOrGetTopic","push","pub","event","forEach","unsubscribeAll","topicId","provider","MainRuntime","PubsubAspect","addRuntime"],"sources":["pubsub.main.runtime.ts"],"sourcesContent":["import { MainRuntime } from '@teambit/cli';\n\nimport { BitBaseEvent } from './bit-base-event';\nimport { PubsubAspect } from './pubsub.aspect';\n\nexport class PubsubMain {\n  private topicMap = {};\n\n  private createOrGetTopic = (topicUUID) => {\n    this.topicMap[topicUUID] = this.topicMap[topicUUID] || [];\n  };\n\n  public sub(topicUUID, callback) {\n    this.createOrGetTopic(topicUUID);\n    this.topicMap[topicUUID].push(callback);\n  }\n\n  public pub(topicUUID, event: BitBaseEvent<any>) {\n    this.createOrGetTopic(topicUUID);\n    this.topicMap[topicUUID].forEach((callback) => callback(event));\n  }\n\n  unsubscribeAll(topicId: string) {\n    delete this.topicMap[topicId];\n  }\n\n  static runtime = MainRuntime;\n\n  static async provider() {\n    return new PubsubMain();\n  }\n}\n\nPubsubAspect.addRuntime(PubsubMain);\n"],"mappings":";;;;;;;;;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAGA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEO,MAAMA,UAAU,CAAC;EAAA;IAAA,kDACH,CAAC,CAAC;IAAA,0DAEOC,SAAS,IAAK;MACxC,IAAI,CAACC,QAAQ,CAACD,SAAS,CAAC,GAAG,IAAI,CAACC,QAAQ,CAACD,SAAS,CAAC,IAAI,EAAE;IAC3D,CAAC;EAAA;EAEME,GAAG,CAACF,SAAS,EAAEG,QAAQ,EAAE;IAC9B,IAAI,CAACC,gBAAgB,CAACJ,SAAS,CAAC;IAChC,IAAI,CAACC,QAAQ,CAACD,SAAS,CAAC,CAACK,IAAI,CAACF,QAAQ,CAAC;EACzC;EAEOG,GAAG,CAACN,SAAS,EAAEO,KAAwB,EAAE;IAC9C,IAAI,CAACH,gBAAgB,CAACJ,SAAS,CAAC;IAChC,IAAI,CAACC,QAAQ,CAACD,SAAS,CAAC,CAACQ,OAAO,CAAEL,QAAQ,IAAKA,QAAQ,CAACI,KAAK,CAAC,CAAC;EACjE;EAEAE,cAAc,CAACC,OAAe,EAAE;IAC9B,OAAO,IAAI,CAACT,QAAQ,CAACS,OAAO,CAAC;EAC/B;EAIA,aAAaC,QAAQ,GAAG;IACtB,OAAO,IAAIZ,UAAU,EAAE;EACzB;AACF;AAAC;AAAA,gCA1BYA,UAAU,aAqBJa,kBAAW;AAO9BC,sBAAY,CAACC,UAAU,CAACf,UAAU,CAAC"}