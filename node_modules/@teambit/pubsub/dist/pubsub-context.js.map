{"version":3,"names":["pubsubRegistry","createContext","undefined","createProvider","pubSubContext","PubSubProvider","children","usePubSub","useContext","usePubSubIframe","ref","pubSub","useEffect","current","destroyConnection","connect"],"sources":["pubsub-context.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, RefObject, ReactNode } from 'react';\n\nexport interface PubSubRegistry {\n  /**\n   * starts a connection to an iframe child.\n   * Returns a destroy() function that will break the connection.\n   */\n  connect(ref: HTMLIFrameElement): () => void;\n}\n\nexport const pubsubRegistry = createContext<PubSubRegistry | undefined>(undefined);\n\nexport function createProvider(pubSubContext: PubSubRegistry) {\n  const PubSubProvider = ({ children }: { children: ReactNode }) => (\n    <pubsubRegistry.Provider value={pubSubContext}>{children}</pubsubRegistry.Provider>\n  );\n\n  return PubSubProvider;\n}\n\nexport function usePubSub() {\n  return useContext(pubsubRegistry);\n}\n\nexport function usePubSubIframe(ref?: RefObject<HTMLIFrameElement>) {\n  const pubSub = usePubSub();\n\n  useEffect(() => {\n    if (!ref?.current || !pubSub) return () => {};\n\n    const destroyConnection = pubSub.connect(ref.current);\n    return () => destroyConnection();\n  }, [ref?.current, pubSub]);\n}\n"],"mappings":";;;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAA0F;AAAA;AAUnF,MAAMA,cAAc,gBAAG,IAAAC,sBAAa,EAA6BC,SAAS,CAAC;AAAC;AAE5E,SAASC,cAAc,CAACC,aAA6B,EAAE;EAC5D,MAAMC,cAAc,GAAG,CAAC;IAAEC;EAAkC,CAAC,kBAC3D,+BAAC,cAAc,CAAC,QAAQ;IAAC,KAAK,EAAEF;EAAc,GAAEE,QAAQ,CACzD;EAED,OAAOD,cAAc;AACvB;AAEO,SAASE,SAAS,GAAG;EAC1B,OAAO,IAAAC,mBAAU,EAACR,cAAc,CAAC;AACnC;AAEO,SAASS,eAAe,CAACC,GAAkC,EAAE;EAClE,MAAMC,MAAM,GAAGJ,SAAS,EAAE;EAE1B,IAAAK,kBAAS,EAAC,MAAM;IACd,IAAI,EAACF,GAAG,aAAHA,GAAG,eAAHA,GAAG,CAAEG,OAAO,KAAI,CAACF,MAAM,EAAE,OAAO,MAAM,CAAC,CAAC;IAE7C,MAAMG,iBAAiB,GAAGH,MAAM,CAACI,OAAO,CAACL,GAAG,CAACG,OAAO,CAAC;IACrD,OAAO,MAAMC,iBAAiB,EAAE;EAClC,CAAC,EAAE,CAACJ,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEG,OAAO,EAAEF,MAAM,CAAC,CAAC;AAC5B"}